---
// src/pages/index.astro
import Layout from "../layouts/Layout.astro";

import Hero from "../components/Hero.astro";
import About from "../components/About.astro";
import Skills from "../components/Skills.astro";

import { getCollection } from "astro:content";

// Récupération des derniers projets et articles
const projects = await getCollection("projects");
const articles = await getCollection("articles");

const recentProjects = projects
  .sort(
    (a, b) =>
      new Date(b.data.publishDate).valueOf() -
      new Date(a.data.publishDate).valueOf()
  )
  .slice(0, 3);

const recentArticles = articles
  .sort(
    (a, b) =>
      new Date(b.data.publishDate).valueOf() -
      new Date(a.data.publishDate).valueOf()
  )
  .slice(0, 3);
---

<Layout title="Accueil">
  <Hero />
  <About />
  <Skills />
</Layout>

<script>
  // Smooth scrolling pour les ancres
  document.querySelectorAll('a[href^="#"]').forEach((anchor) => {
    anchor.addEventListener("click", function (e) {
      e.preventDefault();
      const href = anchor.getAttribute("href");
      const target = href ? document.querySelector(href) : null;
      if (target) {
        target.scrollIntoView({
          behavior: "smooth",
          block: "start",
        });
      }
    });
  });

  // Animation au scroll (optionnel)
  const observerOptions = {
    threshold: 0.1,
    rootMargin: "0px 0px -50px 0px",
  };

  const observer = new IntersectionObserver((entries) => {
    entries.forEach((entry) => {
      if (entry.isIntersecting) {
        entry.target.classList.add("animate-fade-in");
      }
    });
  }, observerOptions);

  // Observer les sections pour les animations
  document.querySelectorAll("section").forEach((section) => {
    observer.observe(section);
  });
</script>

<style>
  /* Animations personnalisées */
  @keyframes fade-in {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .animate-fade-in {
    animation: fade-in 0.6s ease-out forwards;
  }

  /* Effet de parallaxe subtil pour le hero */
  .hero-parallax {
    background-attachment: fixed;
    background-position: center;
    background-repeat: no-repeat;
    background-size: cover;
  }

  /* Amélioration de la lisibilité */
  .line-clamp-3 {
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  /* Styles pour les cartes avec effet hover */
  .card-hover {
    transition: all 0.3s ease;
  }

  .card-hover:hover {
    transform: translateY(-5px);
  }

  /* Responsive typography */
  @media (max-width: 640px) {
    h1 {
      font-size: 2.5rem;
      line-height: 1.2;
    }

    h2 {
      font-size: 2rem;
      line-height: 1.3;
    }
  }
</style>
